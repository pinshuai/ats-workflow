
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Download and post-process MODIS LAI &#8212; ATS workflow</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Write ATS input file" href="write_ATS_input.html" />
    <link rel="prev" title="Download Daymet" href="daymet.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">ATS workflow</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ATS modeling workflow
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model Setup
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mesh.html">
   Example: mesh a delineated watershed
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="daymet.html">
   Download Daymet
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Download and post-process MODIS LAI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="write_ATS_input.html">
   Write ATS input file
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Execute Model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="run.html">
   Run ATS model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model Post-processes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_surface.html">
   Plot surface variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_subsurface.html">
   Plot subsurface variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_evaluation.html">
   Model evaluation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sensitivity Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sensitivity_analysis.html">
   Sensitivity analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model Calibration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="model_calibration.html">
   Model calibration using Machine Learning
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/pinshuai/ats-workflow/main?urlpath=tree/src/chapters/MODIS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/pinshuai/ats-workflow"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/pinshuai/ats-workflow/issues/new?title=Issue%20on%20page%20%2Fchapters/MODIS.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/MODIS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Download and post-process MODIS LAI
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-shapefile-to-provide-the-coordinates">
   Import shapefile to provide the coordinates
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-download-through-usgs-appeears-server">
   Data download through USGS APPEEARS server
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-modis-lai">
     Download MODIS LAI
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-moids-landcover">
     Download MOIDS landcover
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-moids-et">
     Download MOIDS ET
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-moids-snowcover">
     Download MOIDS snowcover
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-the-downloaded-lai-and-lulc-data">
   Use the downloaded LAI and LULC data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subset-data">
   Subset data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lulc-data">
   LULC data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-to-hdf5">
     save to HDF5
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-dominant-lulc-types-and-use-their-lai-values-for-ats-run">
   Select dominant LULC types and use their LAI values for ATS run
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modis-and-nlcd-crosswalk">
   MODIS and NLCD crosswalk
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Download and post-process MODIS LAI</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Download and post-process MODIS LAI
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-shapefile-to-provide-the-coordinates">
   Import shapefile to provide the coordinates
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-download-through-usgs-appeears-server">
   Data download through USGS APPEEARS server
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-modis-lai">
     Download MODIS LAI
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-moids-landcover">
     Download MOIDS landcover
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-moids-et">
     Download MOIDS ET
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-moids-snowcover">
     Download MOIDS snowcover
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-the-downloaded-lai-and-lulc-data">
   Use the downloaded LAI and LULC data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subset-data">
   Subset data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lulc-data">
   LULC data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save-to-hdf5">
     save to HDF5
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#select-dominant-lulc-types-and-use-their-lai-values-for-ats-run">
   Select dominant LULC types and use their LAI values for ATS run
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modis-and-nlcd-crosswalk">
   MODIS and NLCD crosswalk
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="download-and-post-process-modis-lai">
<h1>Download and post-process MODIS LAI<a class="headerlink" href="#download-and-post-process-modis-lai" title="Permalink to this headline">#</a></h1>
<p>MODIS product:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Product</p></th>
<th class="head"><p>File name</p></th>
<th class="head"><p>Spatial resolution</p></th>
<th class="head"><p>Temporal resolution</p></th>
<th class="head"><p>Period</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LAI</p></td>
<td><p>MCD15A3H.006_500m_aid0001.nc</p></td>
<td><p>500-m</p></td>
<td><p>4-day</p></td>
<td><p>2002-07-01 - present</p></td>
</tr>
<tr class="row-odd"><td><p>Landcover</p></td>
<td><p>MCD12Q1.006_500m_aid0001.nc</p></td>
<td><p>500-m</p></td>
<td><p>yearly</p></td>
<td><p>2001-01-01 - present</p></td>
</tr>
<tr class="row-even"><td><p>ET</p></td>
<td><p>MOD16A2GF.006_500m_aid0001.nc</p></td>
<td><p>500-m</p></td>
<td><p>8-day</p></td>
<td><p>2000-01-01 - present</p></td>
</tr>
<tr class="row-odd"><td><p>Snowcover</p></td>
<td><p>MOD10A2.006_500m_aid0001.nc</p></td>
<td><p>500-m</p></td>
<td><p>6-day?</p></td>
<td><p>2000-02-24 - present</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">cgi</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">rioxarray</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>

<span class="kn">import</span> <span class="nn">h5py</span> <span class="k">as</span> <span class="nn">h5</span>

<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">mapping</span>
<span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">requests</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_bounds</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;get the min,max bounds for lat,lon for a given watershed.&quot;&quot;&quot;</span>
    <span class="n">watershed_shape</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">)</span>

    <span class="n">bounds</span> <span class="o">=</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">bounds</span>
    <span class="c1"># bounds</span>

    <span class="n">lonl</span> <span class="o">=</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;minx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lonr</span> <span class="o">=</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;maxx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">latb</span> <span class="o">=</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;miny&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">latt</span> <span class="o">=</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;maxy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    
    
    <span class="k">return</span> <span class="n">lonl</span><span class="p">,</span><span class="n">lonr</span><span class="p">,</span><span class="n">latb</span><span class="p">,</span><span class="n">latt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">submit_request</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">,</span> <span class="n">task_name</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">appeears_username</span><span class="p">,</span> <span class="n">appeears_password</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;01-01-2000&quot;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;12-31-2020&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;create a task for downloading MODIS data using AppEEARS.</span>
<span class="sd">    The step above can take some time (minutes to hours) depending upon the data volume. </span>
<span class="sd">    Please wait until this step is completed!</span>
<span class="sd">    You can check the status of the job here: https://lpdaacsvc.cr.usgs.gov/appeears/explore</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">lonl</span><span class="p">,</span><span class="n">lonr</span><span class="p">,</span><span class="n">latb</span><span class="p">,</span><span class="n">latt</span> <span class="o">=</span> <span class="n">get_bounds</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">)</span>
    
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/login&#39;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">appeears_username</span><span class="p">,</span> <span class="n">appeears_password</span><span class="p">))</span>
    <span class="n">token_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    
    <span class="c1"># creat task JSON file</span>
    <span class="n">task</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;task_type&quot;</span><span class="p">:</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span>
      <span class="s2">&quot;task_name&quot;</span><span class="p">:</span> <span class="n">task_name</span><span class="p">,</span>
      <span class="s2">&quot;params&quot;</span><span class="p">:</span>
      <span class="p">{</span>
        <span class="s2">&quot;dates&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;startDate&quot;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span>
          <span class="s2">&quot;endDate&quot;</span><span class="p">:</span> <span class="n">end_date</span>
        <span class="p">}],</span>
        <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="n">layer</span><span class="p">,</span>
          <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="n">product</span>
        <span class="p">}],</span>
        <span class="s2">&quot;output&quot;</span><span class="p">:</span>
        <span class="p">{</span>
          <span class="s2">&quot;format&quot;</span><span class="p">:</span>
          <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf4&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;geographic&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;geo&quot;</span><span class="p">:</span>
        <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
          <span class="s2">&quot;fileName&quot;</span><span class="p">:</span> <span class="s2">&quot;User-Drawn-Polygon&quot;</span><span class="p">,</span>
          <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span>
            <span class="p">{},</span>
            <span class="s2">&quot;geometry&quot;</span><span class="p">:</span>
            <span class="p">{</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
              <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span>
                  <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latb</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latt</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">lonr</span><span class="p">,</span> <span class="n">latt</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">lonr</span><span class="p">,</span> <span class="n">latb</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latb</span><span class="p">]</span>
                <span class="p">]</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>    
    
    <span class="c1"># submit the task request</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">token_response</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/task&#39;</span><span class="p">,</span> 
        <span class="n">json</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="s1">&#39;Bearer </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">token</span><span class="p">)})</span>
    <span class="n">task_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">task_response</span><span class="p">)</span>
    <span class="n">task_id</span> <span class="o">=</span> <span class="n">task_response</span><span class="p">[</span><span class="s1">&#39;task_id&#39;</span><span class="p">]</span>
    <span class="c1"># print(task_id)    </span>
    
    <span class="k">return</span> <span class="n">task_id</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">dest_dir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download file after the AppEEARS request is complete.&quot;&quot;&quot;</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/bundle/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">))</span>
    <span class="n">bundle_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="c1"># print(bundle_response)</span>

    <span class="n">test</span> <span class="o">=</span> <span class="n">bundle_response</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">]</span>
    <span class="n">test1</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">file_id</span> <span class="o">=</span> <span class="n">test1</span><span class="p">[</span><span class="s1">&#39;file_id&#39;</span><span class="p">]</span>
    <span class="c1"># print(file_id)</span>

    <span class="c1"># Save the LAI.nc dataset into a file</span>
    <span class="c1"># get a stream to the bundle file</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/bundle/</span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">file_id</span><span class="p">),</span>
        <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># parse the filename from the Content-Disposition header</span>
    <span class="n">content_disposition</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">content_disposition</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>

    <span class="c1"># create a destination directory to store the file in</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dest_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># write the file to the destination directory</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File is saved in </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;01-01-2000&quot;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s2">&quot;12-31-2020&quot;</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NeversinkHeadwaters&#39;</span>
<span class="n">fname_watershed_shp</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;../data/shapefile/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.shp&#39;</span>

<span class="n">dest_dir</span> <span class="o">=</span> <span class="s2">&quot;../data/WW_output&quot;</span>
<span class="n">fname_lai</span> <span class="o">=</span> <span class="n">dest_dir</span> <span class="o">+</span> <span class="s1">&#39;/MCD15A3H.006_500m_aid0001.nc&#39;</span>
<span class="n">fname_lulc</span> <span class="o">=</span> <span class="n">dest_dir</span> <span class="o">+</span> <span class="s1">&#39;/MCD12Q1.006_500m_aid0001.nc&#39;</span>
<span class="n">fname_et</span> <span class="o">=</span> <span class="n">dest_dir</span> <span class="o">+</span> <span class="s1">&#39;/MOD16A2GF.006_500m_aid0001.nc&#39;</span>
<span class="n">fname_snowcover</span> <span class="o">=</span> <span class="n">dest_dir</span> <span class="o">+</span> <span class="s1">&#39;/MOD10A2.006_500m_aid0001.nc&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">watershed_shape</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">)</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">bounds</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="import-shapefile-to-provide-the-coordinates">
<h1>Import shapefile to provide the coordinates<a class="headerlink" href="#import-shapefile-to-provide-the-coordinates" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lonl</span><span class="p">,</span><span class="n">lonr</span><span class="p">,</span><span class="n">latb</span><span class="p">,</span><span class="n">latt</span> <span class="o">=</span> <span class="n">get_bounds</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lonl</span><span class="p">,</span><span class="n">lonr</span><span class="p">,</span><span class="n">latb</span><span class="p">,</span><span class="n">latt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-74.61365632247104, -74.35749518209956, 41.88587874311008, 42.035236269932035)
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-download-through-usgs-appeears-server">
<h1>Data download through USGS APPEEARS server<a class="headerlink" href="#data-download-through-usgs-appeears-server" title="Permalink to this headline">#</a></h1>
<p><font color='green'> Provide your NASA Earthdata username and password in the space below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/login&#39;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;USERNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;PASSWORD&#39;</span><span class="p">))</span>
<span class="n">token_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">token_response</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="download-modis-lai">
<h2>Download MODIS LAI<a class="headerlink" href="#download-modis-lai" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">task</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;task_type&quot;</span><span class="p">:</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span>
  <span class="s2">&quot;task_name&quot;</span><span class="p">:</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; LAI&quot;</span><span class="p">,</span>
  <span class="s2">&quot;params&quot;</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s2">&quot;dates&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;startDate&quot;</span><span class="p">:</span> <span class="s2">&quot;07-01-2002&quot;</span><span class="p">,</span>
      <span class="s2">&quot;endDate&quot;</span><span class="p">:</span> <span class="s2">&quot;12-31-2020&quot;</span>
    <span class="p">}],</span>
    <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="s2">&quot;Lai_500m&quot;</span><span class="p">,</span>
      <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="s2">&quot;MCD15A3H.006&quot;</span>
    <span class="p">}],</span>
    <span class="s2">&quot;output&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;format&quot;</span><span class="p">:</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf4&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;geographic&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;geo&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileName&quot;</span><span class="p">:</span> <span class="s2">&quot;User-Drawn-Polygon&quot;</span><span class="p">,</span>
      <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span>
        <span class="p">{},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span>
        <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
          <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span>
              <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latb</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latt</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonr</span><span class="p">,</span> <span class="n">latt</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonr</span><span class="p">,</span> <span class="n">latb</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latb</span><span class="p">]</span>
            <span class="p">]</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># submit the task request</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">token_response</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/task&#39;</span><span class="p">,</span> 
    <span class="n">json</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> 
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="s1">&#39;Bearer </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">token</span><span class="p">)})</span>
<span class="n">task_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">task_response</span><span class="p">)</span>
<span class="n">task_id</span> <span class="o">=</span> <span class="n">task_response</span><span class="p">[</span><span class="s1">&#39;task_id&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;task_id&#39;: &#39;1494e2d1-79eb-4450-8a2d-1671ed7563e2&#39;, &#39;status&#39;: &#39;pending&#39;}
1494e2d1-79eb-4450-8a2d-1671ed7563e2
</pre></div>
</div>
</div>
</div>
<p><font color='green'> The step above can take some time (minutes to hours) depending upon the data volume. Please wait until this step is completed. You can check the status of the job here: <a class="reference external" href="https://lpdaacsvc.cr.usgs.gov/appeears/explore">https://lpdaacsvc.cr.usgs.gov/appeears/explore</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">token</span> <span class="o">=</span> <span class="n">token_response</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/bundle/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">))</span>
<span class="n">bundle_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bundle_response</span><span class="p">)</span>

<span class="n">test</span> <span class="o">=</span> <span class="n">bundle_response</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">]</span>
<span class="n">test1</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#test2 = test1[&#39;file_id&#39;]</span>
<span class="n">file_id</span> <span class="o">=</span> <span class="n">test1</span><span class="p">[</span><span class="s1">&#39;file_id&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>

<span class="c1">#Save the LAI.nc dataset into a file</span>

<span class="c1"># get a stream to the bundle file</span>
<span class="c1">#task_id = &#39;7cbc128a-3f07-4630-835e-4a41e40c07d8&#39;</span>
<span class="c1">#file_id = &#39;209d887a-0ab9-465b-9634-58a610b99c09&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/bundle/</span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">file_id</span><span class="p">),</span>
    <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># parse the filename from the Content-Disposition header</span>
<span class="n">content_disposition</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">content_disposition</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>

<span class="c1"># create a destination directory to store the file in</span>

<span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dest_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># write the file to the destination directory</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-moids-landcover">
<h2>Download MOIDS landcover<a class="headerlink" href="#download-moids-landcover" title="Permalink to this headline">#</a></h2>
<p>Landcover product from MODIS starts with <code class="docutils literal notranslate"><span class="pre">MCD12Q1.006</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##Download LULC data</span>
<span class="n">task1</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">&quot;task_type&quot;</span><span class="p">:</span> <span class="s2">&quot;area&quot;</span><span class="p">,</span>
  <span class="s2">&quot;task_name&quot;</span><span class="p">:</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; LULC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;params&quot;</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s2">&quot;dates&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;startDate&quot;</span><span class="p">:</span> <span class="s2">&quot;07-01-2002&quot;</span><span class="p">,</span>
      <span class="s2">&quot;endDate&quot;</span><span class="p">:</span> <span class="s2">&quot;12-31-2020&quot;</span>
    <span class="p">}],</span>
    <span class="s2">&quot;layers&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="s2">&quot;LC_Type1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;product&quot;</span><span class="p">:</span> <span class="s2">&quot;MCD12Q1.006&quot;</span>
    <span class="p">}],</span>
    <span class="s2">&quot;output&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;format&quot;</span><span class="p">:</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf4&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;geographic&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;geo&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fileName&quot;</span><span class="p">:</span> <span class="s2">&quot;User-Drawn-Polygon&quot;</span><span class="p">,</span>
      <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span>
        <span class="p">{},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span>
        <span class="p">{</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
          <span class="s2">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span>
              <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latb</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latt</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonr</span><span class="p">,</span> <span class="n">latt</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonr</span><span class="p">,</span> <span class="n">latb</span><span class="p">],</span>
              <span class="p">[</span><span class="n">lonl</span><span class="p">,</span> <span class="n">latb</span><span class="p">]</span>
            <span class="p">]</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># submit the task request</span>
<span class="n">token1</span> <span class="o">=</span> <span class="n">token_response</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span>
<span class="n">response1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/task&#39;</span><span class="p">,</span> 
    <span class="n">json</span><span class="o">=</span><span class="n">task1</span><span class="p">,</span> 
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="s1">&#39;Bearer </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">token</span><span class="p">)})</span>
<span class="n">task_response1</span> <span class="o">=</span> <span class="n">response1</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">task_response1</span><span class="p">)</span>
<span class="n">task_id1</span> <span class="o">=</span> <span class="n">task_response1</span><span class="p">[</span><span class="s1">&#39;task_id&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">task_id1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;task_id&#39;: &#39;d28ac41b-34c8-40d1-99ec-184268f92d1f&#39;, &#39;status&#39;: &#39;pending&#39;}
d28ac41b-34c8-40d1-99ec-184268f92d1f
</pre></div>
</div>
</div>
</div>
<p><font color='green'> The step above can take some time (minutes to hours) depending upon the data volume. Please wait until this step is completed. You can check the status of the job here: <a class="reference external" href="https://lpdaacsvc.cr.usgs.gov/appeears/explore">https://lpdaacsvc.cr.usgs.gov/appeears/explore</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">token</span> <span class="o">=</span> <span class="n">token_response</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span>
<span class="n">response1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/bundle/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id1</span><span class="p">))</span>
<span class="n">bundle_response1</span> <span class="o">=</span> <span class="n">response1</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bundle_response1</span><span class="p">)</span>

<span class="n">files1</span> <span class="o">=</span> <span class="n">bundle_response1</span><span class="p">[</span><span class="s1">&#39;files&#39;</span><span class="p">]</span>
<span class="n">files2</span> <span class="o">=</span> <span class="n">files1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">file_id1</span> <span class="o">=</span> <span class="n">files2</span><span class="p">[</span><span class="s1">&#39;file_id&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">file_id1</span><span class="p">)</span>

<span class="c1"># get a stream to the bundle file</span>
<span class="c1">#task_id = &#39;7cbc128a-3f07-4630-835e-4a41e40c07d8&#39;</span>
<span class="c1">#file_id = &#39;209d887a-0ab9-465b-9634-58a610b99c09&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s1">&#39;https://lpdaacsvc.cr.usgs.gov/appeears/api/bundle/</span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_id1</span><span class="p">,</span> <span class="n">file_id1</span><span class="p">),</span>
    <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># parse the filename from the Content-Disposition header</span>
<span class="n">content_disposition</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">parse_header</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">content_disposition</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>

<span class="c1"># create a destination directory to store the file in</span>
<span class="c1"># dest_dir = &quot;../data-raw&quot;</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dest_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># write the file to the destination directory</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;files&#39;: [{&#39;sha256&#39;: &#39;753a4e744ca04ff5a96bb2af8be320b4ec6571c28d01def3e6eab9dbb3a55872&#39;, &#39;file_id&#39;: &#39;1cc69501-e598-4ae9-b2b0-3e2ba71f96db&#39;, &#39;file_name&#39;: &#39;MCD12Q1.006_500m_aid0001.nc&#39;, &#39;file_size&#39;: 28301, &#39;file_type&#39;: &#39;nc&#39;}, {&#39;sha256&#39;: &#39;d29d9a15144007340d7b2df860d3b1d9226f1eb645b2df3527b720722ceec1f4&#39;, &#39;file_id&#39;: &#39;2ad122be-7db2-4aab-9f26-a43f59fd3578&#39;, &#39;file_name&#39;: &#39;MCD12Q1-006-QC-lookup.csv&#39;, &#39;file_size&#39;: 99, &#39;file_type&#39;: &#39;csv&#39;}, {&#39;sha256&#39;: &#39;6d18320f61fde34173bd0f3c70aec92a6e30dca827e97b02fce706b5e0f3f8c9&#39;, &#39;file_id&#39;: &#39;d70aeae3-9cc2-430b-99c7-eab96e27a48b&#39;, &#39;file_name&#39;: &#39;MCD12Q1-006-QC-Statistics-QA.csv&#39;, &#39;file_size&#39;: 833, &#39;file_type&#39;: &#39;csv&#39;}, {&#39;sha256&#39;: &#39;71bd0920bb638a75e7c80a1f1f12324f2d2f4666140c936d62425ec741605e19&#39;, &#39;file_id&#39;: &#39;c7054d71-6008-4461-8f4c-dbd782c532b4&#39;, &#39;file_name&#39;: &#39;MCD12Q1-006-LC-Type1-Statistics.csv&#39;, &#39;file_size&#39;: 1109, &#39;file_type&#39;: &#39;csv&#39;}, {&#39;sha256&#39;: &#39;dcb3d7f97d1d506e332bc7f8241ffe43cafc34bad5d0af30bd1ecd56812cdb8f&#39;, &#39;file_id&#39;: &#39;96b32324-34d0-4db4-8839-1de9afcff479&#39;, &#39;file_name&#39;: &#39;NeversinkHeadwaters-LULC-granule-list.txt&#39;, &#39;file_size&#39;: 2185, &#39;file_type&#39;: &#39;txt&#39;}, {&#39;sha256&#39;: &#39;d9c88f69c68e33d7951c23a38cd4e1720bc84acedbcdfbe39fb1d49722217c2b&#39;, &#39;file_id&#39;: &#39;dfe91be9-085c-4e06-8f3e-e39a6b372382&#39;, &#39;file_name&#39;: &#39;NeversinkHeadwaters-LULC-request.json&#39;, &#39;file_size&#39;: 1120, &#39;file_type&#39;: &#39;json&#39;}, {&#39;sha256&#39;: &#39;69515c0ca5ca5ee457904f2f4408b1d6e4bb2186ed5323518e46a43125066ddf&#39;, &#39;file_id&#39;: &#39;3190c3cb-decf-4c6f-b615-82e9552846a9&#39;, &#39;file_name&#39;: &#39;NeversinkHeadwaters-LULC-MCD12Q1-006-metadata.xml&#39;, &#39;file_size&#39;: 22119, &#39;file_type&#39;: &#39;xml&#39;}, {&#39;sha256&#39;: &#39;205d94d93a7d22f82865bf05faa234dd1946d8064fb30e8bef21ad9e88ffd2a5&#39;, &#39;file_id&#39;: &#39;8d08db13-c025-4c07-a7dc-ae51d04dd6bf&#39;, &#39;file_name&#39;: &#39;README.md&#39;, &#39;file_size&#39;: 23372, &#39;file_type&#39;: &#39;txt&#39;}], &#39;created&#39;: &#39;2022-01-10T18:48:41.551191&#39;, &#39;task_id&#39;: &#39;d28ac41b-34c8-40d1-99ec-184268f92d1f&#39;, &#39;updated&#39;: &#39;2022-01-10T18:49:01.917148&#39;, &#39;bundle_type&#39;: &#39;area&#39;}
1cc69501-e598-4ae9-b2b0-3e2ba71f96db
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-moids-et">
<h2>Download MOIDS ET<a class="headerlink" href="#download-moids-et" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">task_id</span> <span class="o">=</span> <span class="n">submit_request</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span> <span class="s1">&#39; ET-test&#39;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;MOD16A2GF.006&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s2">&quot;ET_500m&quot;</span><span class="p">,</span> 
                         <span class="n">appeears_username</span> <span class="o">=</span> <span class="s1">&#39;USERNAME&#39;</span><span class="p">,</span> <span class="n">appeears_password</span><span class="o">=</span><span class="s1">&#39;PASSWORD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;task_id&#39;: &#39;be9b3775-d3d5-40d3-b15e-18123e127c5c&#39;, &#39;status&#39;: &#39;pending&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_file</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">dest_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File is saved in ../data/WW_output/MOD16A2GF.006_500m_aid0001.nc!
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-moids-snowcover">
<h2>Download MOIDS snowcover<a class="headerlink" href="#download-moids-snowcover" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">task_id</span> <span class="o">=</span> <span class="n">submit_request</span><span class="p">(</span><span class="n">fname_watershed_shp</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="n">name</span><span class="o">+</span> <span class="s1">&#39; snowcover&#39;</span><span class="p">,</span> <span class="n">product</span><span class="o">=</span><span class="s2">&quot;MOD10A2.006&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s2">&quot;Maximum_Snow_Extent&quot;</span><span class="p">,</span> 
                         <span class="n">appeears_username</span> <span class="o">=</span> <span class="s1">&#39;USERNAME&#39;</span><span class="p">,</span> <span class="n">appeears_password</span><span class="o">=</span><span class="s1">&#39;PASSWORD&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;task_id&#39;: &#39;d0ec3b97-483a-4221-8ad0-cc2b7230fe5c&#39;, &#39;status&#39;: &#39;pending&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_file</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">dest_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File is saved in ../data/WW_output/MOD10A2.006_500m_aid0001.nc!
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="use-the-downloaded-lai-and-lulc-data">
<h1>Use the downloaded LAI and LULC data<a class="headerlink" href="#use-the-downloaded-lai-and-lulc-data" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">fname_lai</span><span class="p">)</span>

<span class="n">dset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (lat: 37, lon: 63, time: 1698)
Coordinates:
  * time          (time) object 2002-07-04 00:00:00 ... 2020-12-30 00:00:00
  * lat           (lat) float64 42.04 42.03 42.03 42.02 ... 41.89 41.89 41.89
  * lon           (lon) float64 -74.61 -74.61 -74.61 ... -74.36 -74.36 -74.36
Data variables:
    crs           int8 -127
    Lai_500m      (time, lat, lon) float32 ...
    FparLai_QC    (time, lat, lon) float32 ...
    FparExtra_QC  (time, lat, lon) float32 ...
Attributes:
    title:        MCD15A3H.006 for aid0001
    Conventions:  CF-1.6
    institution:  Land Processes Distributed Active Archive Center (LP DAAC)
    source:       AppEEARS v2.68
    references:   See README.md
    history:      See README.md</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a1ce2f28-acf6-4a1a-a558-5eaafbcff923' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a1ce2f28-acf6-4a1a-a558-5eaafbcff923' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 37</li><li><span class='xr-has-index'>lon</span>: 63</li><li><span class='xr-has-index'>time</span>: 1698</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7a82e03d-7090-4fe6-bc66-292c70e5b51f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7a82e03d-7090-4fe6-bc66-292c70e5b51f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2002-07-04 00:00:00 ... 2020-12-...</div><input id='attrs-edee04a4-6488-490f-9ce7-f46d7a8834dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-edee04a4-6488-490f-9ce7-f46d7a8834dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b151cbd7-6027-4825-9a20-a94730bfb5c2' class='xr-var-data-in' type='checkbox'><label for='data-b151cbd7-6027-4825-9a20-a94730bfb5c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeJulian(2002, 7, 4, 0, 0, 0, 0),
       cftime.DatetimeJulian(2002, 7, 8, 0, 0, 0, 0),
       cftime.DatetimeJulian(2002, 7, 12, 0, 0, 0, 0), ...,
       cftime.DatetimeJulian(2020, 12, 22, 0, 0, 0, 0),
       cftime.DatetimeJulian(2020, 12, 26, 0, 0, 0, 0),
       cftime.DatetimeJulian(2020, 12, 30, 0, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>42.04 42.03 42.03 ... 41.89 41.89</div><input id='attrs-beedfd92-07fe-4d60-8507-8382dff974d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-beedfd92-07fe-4d60-8507-8382dff974d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2abf9ada-5f13-4017-b8bf-133ec7fba2ea' class='xr-var-data-in' type='checkbox'><label for='data-2abf9ada-5f13-4017-b8bf-133ec7fba2ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>_CoordinateAxisType :</span></dt><dd>GeoY</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([42.035417, 42.03125 , 42.027083, 42.022917, 42.01875 , 42.014583,
       42.010417, 42.00625 , 42.002083, 41.997917, 41.99375 , 41.989583,
       41.985417, 41.98125 , 41.977083, 41.972917, 41.96875 , 41.964583,
       41.960417, 41.95625 , 41.952083, 41.947917, 41.94375 , 41.939583,
       41.935417, 41.93125 , 41.927083, 41.922917, 41.91875 , 41.914583,
       41.910417, 41.90625 , 41.902083, 41.897917, 41.89375 , 41.889583,
       41.885417])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-74.61 -74.61 ... -74.36 -74.36</div><input id='attrs-71fd68fa-8c54-46be-9be8-cdbb0ac824de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-71fd68fa-8c54-46be-9be8-cdbb0ac824de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-44ca2540-1db5-46fb-8ca1-1316225b547f' class='xr-var-data-in' type='checkbox'><label for='data-44ca2540-1db5-46fb-8ca1-1316225b547f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>_CoordinateAxisType :</span></dt><dd>GeoX</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-74.614583, -74.610417, -74.60625 , -74.602083, -74.597917, -74.59375 ,
       -74.589583, -74.585417, -74.58125 , -74.577083, -74.572917, -74.56875 ,
       -74.564583, -74.560417, -74.55625 , -74.552083, -74.547917, -74.54375 ,
       -74.539583, -74.535417, -74.53125 , -74.527083, -74.522917, -74.51875 ,
       -74.514583, -74.510417, -74.50625 , -74.502083, -74.497917, -74.49375 ,
       -74.489583, -74.485417, -74.48125 , -74.477083, -74.472917, -74.46875 ,
       -74.464583, -74.460417, -74.45625 , -74.452083, -74.447917, -74.44375 ,
       -74.439583, -74.435417, -74.43125 , -74.427083, -74.422917, -74.41875 ,
       -74.414583, -74.410417, -74.40625 , -74.402083, -74.397917, -74.39375 ,
       -74.389583, -74.385417, -74.38125 , -74.377083, -74.372917, -74.36875 ,
       -74.364583, -74.360417, -74.35625 ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-27531a41-19bc-487c-b701-a117e19f39d7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-27531a41-19bc-487c-b701-a117e19f39d7' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3161f919-d93c-41a0-9a1c-4456c5767c13' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3161f919-d93c-41a0-9a1c-4456c5767c13' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-533f3735-92eb-4af4-95e4-3605a1a0c70a' class='xr-var-data-in' type='checkbox'><label for='data-533f3735-92eb-4af4-95e4-3605a1a0c70a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>_CoordinateAxisTypes :</span></dt><dd>GeoX GeoY</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;unknown&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Longitude&quot;,EAST],AXIS[&quot;Latitude&quot;,NORTH]]</dd><dt><span>epsg_code :</span></dt><dd>4326</dd><dt><span>semi_major_axis :</span></dt><dd>6378137</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array(-127, dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Lai_500m</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0e9f0cb4-9b06-4eeb-9237-f215ffa55910' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e9f0cb4-9b06-4eeb-9237-f215ffa55910' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc4b186c-fa22-43ff-94af-4fe0ac672f5d' class='xr-var-data-in' type='checkbox'><label for='data-cc4b186c-fa22-43ff-94af-4fe0ac672f5d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>100</dd><dt><span>scale_factor_err :</span></dt><dd>0.0</dd><dt><span>add_offset_err :</span></dt><dd>0.0</dd><dt><span>calibrated_nt :</span></dt><dd>21</dd><dt><span>long_name :</span></dt><dd>MCD15A3H MODIS/Terra Gridded 500M Leaf Area Index LAI (4-day composite)</dd><dt><span>units :</span></dt><dd>m^2/m^2</dd><dt><span>MOD15A2_FILLVALUE_DOC :</span></dt><dd>MOD15A2 FILL VALUE LEGEND
255 = _Fillvalue, assigned when:
    * the MOD09GA suf. reflectance for channel VIS, NIR was assigned its _Fillvalue, or
    * land cover pixel itself was assigned _Fillvalus 255 or 254.
254 = land cover assigned as perennial salt or inland fresh water.
253 = land cover assigned as barren, sparse vegetation (rock, tundra, desert.)
252 = land cover assigned as perennial snow, ice.
251 = land cover assigned as \&quot;permanent\&quot; wetlands/inundated marshlands.
250 = land cover assigned as urban/built-up.
249 = land cover assigned as \&quot;unclassified\&quot; or not able to determine.
</dd></dl></div><div class='xr-var-data'><pre>[3958038 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>FparLai_QC</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d2828891-ac6b-45f5-8fe7-2827a3835af2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2828891-ac6b-45f5-8fe7-2827a3835af2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8af3b2f-c81c-4e14-9586-258259b06449' class='xr-var-data-in' type='checkbox'><label for='data-e8af3b2f-c81c-4e14-9586-258259b06449' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>254</dd><dt><span>long_name :</span></dt><dd>MCD15A3H MODIS/Terra+Aqua QC for FPAR and LAI (4-day composite)</dd><dt><span>units :</span></dt><dd>class-flag</dd><dt><span>FparLai_QC_DOC :</span></dt><dd>
FparLai_QC 5 BITFIELDS IN 8 BITWORD
MODLAND_QC START 0 END 0 VALIDS 2
MODLAND_QC   0 = Good Quality (main algorithm with or without saturation)
MODLAND_QC   1 = Other Quality (back-up algorithm or fill value)
SENSOR START 1 END 1 VALIDS 2
SENSOR       0  = Terra
SENSOR       1  = Aqua
DEADDETECTOR START 2 END 2 VALIDS 2
DEADDETECTOR 0 = Detectors apparently fine for up to 50% of channels 1,2
DEADDETECTOR 1 = Dead detectors caused &gt;50% adjacent detector retrieval
CLOUDSTATE START 3 END 4 VALIDS 4 (this inherited from Aggregate_QC bits {0,1} cloud state)
CLOUDSTATE   00 = 0 Significant clouds NOT present (clear)
CLOUDSTATE   01 = 1 Significant clouds WERE present
CLOUDSTATE   10 = 2 Mixed cloud present on pixel
CLOUDSTATE   11 = 3 Cloud state not defined,assumed clear
SCF_QC START 5 END 7 VALIDS 5
SCF_QC       000=0 Main (RT) algorithm used, best result possible (no saturation)
SCF_QC       001=1 Main (RT) algorithm used, saturation occured. Good, very usable.
SCF_QC       010=2 Main algorithm failed due to bad geometry, empirical algorithm used
SCF_QC       011=3 Main algorithm faild due to problems other than geometry, empirical algorithm used
SCF_QC       100=4 Pixel not produced at all, value coudn&#x27;t be retrieved (possible reasons: bad L1B data, unusable MOD09GA data)
</dd></dl></div><div class='xr-var-data'><pre>[3958038 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>FparExtra_QC</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b4ede706-5f09-4a42-9b35-0ab8096826ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b4ede706-5f09-4a42-9b35-0ab8096826ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a54f04cc-2fa5-43aa-9a8f-01249e93fb55' class='xr-var-data-in' type='checkbox'><label for='data-a54f04cc-2fa5-43aa-9a8f-01249e93fb55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>254</dd><dt><span>long_name :</span></dt><dd>MCD15A3H MODIS/Terra+Aqua pass-through QC for FPAR and LAI (4-day composite)</dd><dt><span>units :</span></dt><dd>class-flag</dd><dt><span>FparExtra_QC_DOC :</span></dt><dd>
FparExtra_QC 6 BITFIELDS IN 8 BITWORD
LANDSEA PASS-THROUGH START 0 END 1 VALIDS 4
LANDSEA   00 = 0 LAND       AggrQC(3,5)values{001}
LANDSEA   01 = 1 SHORE      AggrQC(3,5)values{000,010,100}
LANDSEA   10 = 2 FRESHWATER AggrQC(3,5)values{011,101}
LANDSEA   11 = 3 OCEAN      AggrQC(3,5)values{110,111}
SNOW_ICE (from Aggregate_QC bits) START 2 END 2 VALIDS 2
SNOW_ICE  0 = No snow/ice detected
SNOW_ICE  1 = Snow/ice were detected
AEROSOL START 3 END 3 VALIDS 2
AEROSOL   0 = No or low atmospheric aerosol levels detected
AEROSOL   1 = Average or high aerosol levels detected
CIRRUS (from Aggregate_QC bits {8,9} ) START 4 END 4 VALIDS 2
CIRRUS    0 = No cirrus detected
CIRRUS    1 = Cirrus was detected
INTERNAL_CLOUD_MASK START 5 END 5 VALIDS 2
INTERNAL_CLOUD_MASK 0 = No clouds
INTERNAL_CLOUD_MASK 1 = Clouds were detected
CLOUD_SHADOW START 6 END 6 VALIDS 2
CLOUD_SHADOW        0 = No cloud shadow detected
CLOUD_SHADOW        1 = Cloud shadow detected
SCF_BIOME_MASK START 7 END 7 VALIDS 2
SCF_BIOME_MASK  0 = Biome outside interval &lt;1,4&gt;
SCF_BIOME_MASK  1 = Biome in interval &lt;1,4&gt;
</dd></dl></div><div class='xr-var-data'><pre>[3958038 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4fd7519b-9647-4644-9164-3e5667f58661' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4fd7519b-9647-4644-9164-3e5667f58661' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>MCD15A3H.006 for aid0001</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>institution :</span></dt><dd>Land Processes Distributed Active Archive Center (LP DAAC)</dd><dt><span>source :</span></dt><dd>AppEEARS v2.68</dd><dt><span>references :</span></dt><dd>See README.md</dd><dt><span>history :</span></dt><dd>See README.md</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">Lai_500m</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1698, 37, 63)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;xarray.DataArray &#39;Lai_500m&#39; ()&gt;
 array(0., dtype=float32),
 &lt;xarray.DataArray &#39;Lai_500m&#39; ()&gt;
 array(7., dtype=float32))
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="subset-data">
<h1>Subset data<a class="headerlink" href="#subset-data" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">mask_data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">mask_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;xarray.DataArray &#39;Lai_500m&#39; ()&gt;
 array(0., dtype=float32),
 &lt;xarray.DataArray &#39;Lai_500m&#39; ()&gt;
 array(7., dtype=float32))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask_data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x1aa52b940&gt;
</pre></div>
</div>
<img alt="../_images/MODIS_36_1.png" src="../_images/MODIS_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mask_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">clipped_data</span> <span class="o">=</span> <span class="n">mask_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">watershed_shape</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mapping</span><span class="p">),</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LAI_data</span> <span class="o">=</span> <span class="n">clipped_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">clipped_data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">robust</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">watershed_shape</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;minx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;maxx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;miny&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;maxy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(41.88587874311008, 42.035236269932035)
</pre></div>
</div>
<img alt="../_images/MODIS_39_1.png" src="../_images/MODIS_39_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped_data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">robust</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x1ad6b1460&gt;
</pre></div>
</div>
<img alt="../_images/MODIS_40_1.png" src="../_images/MODIS_40_1.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lulc-data">
<h1>LULC data<a class="headerlink" href="#lulc-data" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">fname_lulc</span><span class="p">)</span>
<span class="n">dset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (lat: 37, lon: 63, time: 19)
Coordinates:
  * time      (time) object 2002-01-01 00:00:00 ... 2020-01-01 00:00:00
  * lat       (lat) float64 42.04 42.03 42.03 42.02 ... 41.9 41.89 41.89 41.89
  * lon       (lon) float64 -74.61 -74.61 -74.61 -74.6 ... -74.36 -74.36 -74.36
Data variables:
    crs       int8 -127
    LC_Type1  (time, lat, lon) float32 4.0 4.0 4.0 4.0 4.0 ... 4.0 4.0 4.0 4.0
    QC        (time, lat, lon) float32 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0
Attributes:
    title:        MCD12Q1.006 for aid0001
    Conventions:  CF-1.6
    institution:  Land Processes Distributed Active Archive Center (LP DAAC)
    source:       AppEEARS v2.68
    references:   See README.md
    history:      See README.md</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b1539502-6183-4be0-ad62-c20a4f477a4f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b1539502-6183-4be0-ad62-c20a4f477a4f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 37</li><li><span class='xr-has-index'>lon</span>: 63</li><li><span class='xr-has-index'>time</span>: 19</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d2107432-65c1-4503-ae17-98908317f83d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d2107432-65c1-4503-ae17-98908317f83d' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2002-01-01 00:00:00 ... 2020-01-...</div><input id='attrs-7a948870-6a48-4331-94ac-4864e34b0430' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a948870-6a48-4331-94ac-4864e34b0430' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c3a50e02-a939-4bc0-afe5-cb52427ad7ef' class='xr-var-data-in' type='checkbox'><label for='data-c3a50e02-a939-4bc0-afe5-cb52427ad7ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeJulian(2002, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2003, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2004, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2005, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2006, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2007, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2008, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2009, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2010, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2011, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2012, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2013, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2014, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2015, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2016, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2017, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2018, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2019, 1, 1, 0, 0, 0, 0),
       cftime.DatetimeJulian(2020, 1, 1, 0, 0, 0, 0)], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>42.04 42.03 42.03 ... 41.89 41.89</div><input id='attrs-8ffe3cf5-f0b9-4c89-b804-e6e8113213d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8ffe3cf5-f0b9-4c89-b804-e6e8113213d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b093eb4-e461-48f7-be11-65d639ddaeb1' class='xr-var-data-in' type='checkbox'><label for='data-7b093eb4-e461-48f7-be11-65d639ddaeb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>_CoordinateAxisType :</span></dt><dd>GeoY</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([42.035417, 42.03125 , 42.027083, 42.022917, 42.01875 , 42.014583,
       42.010417, 42.00625 , 42.002083, 41.997917, 41.99375 , 41.989583,
       41.985417, 41.98125 , 41.977083, 41.972917, 41.96875 , 41.964583,
       41.960417, 41.95625 , 41.952083, 41.947917, 41.94375 , 41.939583,
       41.935417, 41.93125 , 41.927083, 41.922917, 41.91875 , 41.914583,
       41.910417, 41.90625 , 41.902083, 41.897917, 41.89375 , 41.889583,
       41.885417])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-74.61 -74.61 ... -74.36 -74.36</div><input id='attrs-a6442ee0-ce58-4661-a2d6-6c1192f04166' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a6442ee0-ce58-4661-a2d6-6c1192f04166' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4365f859-b434-4f6f-88dc-c115eda82877' class='xr-var-data-in' type='checkbox'><label for='data-4365f859-b434-4f6f-88dc-c115eda82877' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>_CoordinateAxisType :</span></dt><dd>GeoX</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-74.614583, -74.610417, -74.60625 , -74.602083, -74.597917, -74.59375 ,
       -74.589583, -74.585417, -74.58125 , -74.577083, -74.572917, -74.56875 ,
       -74.564583, -74.560417, -74.55625 , -74.552083, -74.547917, -74.54375 ,
       -74.539583, -74.535417, -74.53125 , -74.527083, -74.522917, -74.51875 ,
       -74.514583, -74.510417, -74.50625 , -74.502083, -74.497917, -74.49375 ,
       -74.489583, -74.485417, -74.48125 , -74.477083, -74.472917, -74.46875 ,
       -74.464583, -74.460417, -74.45625 , -74.452083, -74.447917, -74.44375 ,
       -74.439583, -74.435417, -74.43125 , -74.427083, -74.422917, -74.41875 ,
       -74.414583, -74.410417, -74.40625 , -74.402083, -74.397917, -74.39375 ,
       -74.389583, -74.385417, -74.38125 , -74.377083, -74.372917, -74.36875 ,
       -74.364583, -74.360417, -74.35625 ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e6ec179d-2969-4e9c-88fb-38a303779919' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6ec179d-2969-4e9c-88fb-38a303779919' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d9e98f86-53ef-4b14-bfde-aa651ba4b7ec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9e98f86-53ef-4b14-bfde-aa651ba4b7ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fe7e1a0-455f-4f75-9de0-52d2aa60cc72' class='xr-var-data-in' type='checkbox'><label for='data-5fe7e1a0-455f-4f75-9de0-52d2aa60cc72' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>_CoordinateAxisTypes :</span></dt><dd>GeoX GeoY</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;unknown&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Longitude&quot;,EAST],AXIS[&quot;Latitude&quot;,NORTH]]</dd><dt><span>epsg_code :</span></dt><dd>4326</dd><dt><span>semi_major_axis :</span></dt><dd>6378137</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array(-127, dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>LC_Type1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b8b0dcde-ca8a-40b5-9814-4268c417f449' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b8b0dcde-ca8a-40b5-9814-4268c417f449' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82a62dee-0a08-4ca4-bcee-56da315fcf46' class='xr-var-data-in' type='checkbox'><label for='data-82a62dee-0a08-4ca4-bcee-56da315fcf46' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>17</dd><dt><span>long_name :</span></dt><dd>Land_Cover_Type_1</dd><dt><span>Evergreen_Needleleaf_Forests :</span></dt><dd>1</dd><dt><span>Evergreen_Broadleaf_Forests :</span></dt><dd>2</dd><dt><span>Deciduous_Needleleaf_Forests :</span></dt><dd>3</dd><dt><span>Deciduous_Broadleaf_Forests :</span></dt><dd>4</dd><dt><span>Mixed_Forests :</span></dt><dd>5</dd><dt><span>Closed_Shrublands :</span></dt><dd>6</dd><dt><span>Open_Shrublands :</span></dt><dd>7</dd><dt><span>Woody_Savannas :</span></dt><dd>8</dd><dt><span>Savannas :</span></dt><dd>9</dd><dt><span>Grasslands :</span></dt><dd>10</dd><dt><span>Permanent_Wetlands :</span></dt><dd>11</dd><dt><span>Croplands :</span></dt><dd>12</dd><dt><span>Urban_and_Built_up_Lands :</span></dt><dd>13</dd><dt><span>Cropland_Natural_Vegetation_Mosaics :</span></dt><dd>14</dd><dt><span>Permanent_Snow_and_Ice :</span></dt><dd>15</dd><dt><span>Barren :</span></dt><dd>16</dd><dt><span>Water_Bodies :</span></dt><dd>17</dd><dt><span>Unclassified :</span></dt><dd>-1</dd></dl></div><div class='xr-var-data'><pre>array([[[4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.],
        ...,
        [4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.]],

       [[4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.],
        ...,
        [4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.]],

       ...,

       [[4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.],
        ...,
        [4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.]],

       [[4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.],
        ...,
        [4., 4., ..., 4., 4.],
        [4., 4., ..., 4., 4.]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>QC</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e7713209-ed8a-45e5-86db-2e409de754a0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e7713209-ed8a-45e5-86db-2e409de754a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72d7f6c3-896d-4187-a30c-dc84215dae38' class='xr-var-data-in' type='checkbox'><label for='data-72d7f6c3-896d-4187-a30c-dc84215dae38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>10</dd><dt><span>long_name :</span></dt><dd>Quality_Flags</dd></dl></div><div class='xr-var-data'><pre>array([[[0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.],
        ...,
        [0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.]],

       [[0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.],
        ...,
        [0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.]],

       ...,

       [[0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.],
        ...,
        [0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.]],

       [[0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.],
        ...,
        [0., 0., ..., 0., 0.],
        [0., 0., ..., 0., 0.]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d95977a8-ca66-4290-b5f2-c1173fc48a17' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d95977a8-ca66-4290-b5f2-c1173fc48a17' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>MCD12Q1.006 for aid0001</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>institution :</span></dt><dd>Land Processes Distributed Active Archive Center (LP DAAC)</dd><dt><span>source :</span></dt><dd>AppEEARS v2.68</dd><dt><span>references :</span></dt><dd>See README.md</dd><dt><span>history :</span></dt><dd>See README.md</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">LC_Type1</span>

<span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(19, 37, 63)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ids</span><span class="p">,</span> <span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([4., 5., 8.], dtype=float32), array([43635,   621,    33]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Colors are based on NLCD LULC colors</span>
<span class="n">lc_type1_colors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="p">(</span><span class="s1">&#39;Unclassified&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.00000000000</span><span class="p">,</span>  <span class="mf">0.00000000000</span><span class="p">,</span>  <span class="mf">0.00000000000</span><span class="p">)),</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Open Water&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.27843137255</span><span class="p">,</span>  <span class="mf">0.41960784314</span><span class="p">,</span>  <span class="mf">0.62745098039</span><span class="p">)),</span>
        <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Evergreen Needleleaf Forests&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.10980392157</span><span class="p">,</span>  <span class="mf">0.38823529412</span><span class="p">,</span>  <span class="mf">0.18823529412</span><span class="p">)),</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Evergreen Broadleaf Forests&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.10980392157</span><span class="p">,</span>  <span class="mf">0.38823529412</span><span class="p">,</span>  <span class="mf">0.18823529412</span><span class="p">)),</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Deciduous Needleleaf Forests&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.40784313726</span><span class="p">,</span>  <span class="mf">0.66666666667</span><span class="p">,</span>  <span class="mf">0.38823529412</span><span class="p">)),</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Deciduous Broadleaf Forests&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.40784313726</span><span class="p">,</span>  <span class="mf">0.66666666667</span><span class="p">,</span>  <span class="mf">0.38823529412</span><span class="p">)),</span>
        <span class="mi">5</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Mixed Forests&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.70980392157</span><span class="p">,</span>  <span class="mf">0.78823529412</span><span class="p">,</span>  <span class="mf">0.55686274510</span><span class="p">)),</span>
        <span class="mi">6</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Closed Shrublands&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.80000000000</span><span class="p">,</span>  <span class="mf">0.72941176471</span><span class="p">,</span>  <span class="mf">0.48627450980</span><span class="p">)),</span>
        <span class="mi">7</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Open Shrublands&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.80000000000</span><span class="p">,</span>  <span class="mf">0.72941176471</span><span class="p">,</span>  <span class="mf">0.48627450980</span><span class="p">)),</span>
        <span class="c1"># 8: (&#39;Woody Savannas&#39;, (0.40784313726,  0.66666666667,  0.38823529412)),</span>
        <span class="mi">8</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Woody Savannas&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.60980392157</span><span class="p">,</span>  <span class="mf">0.68823529412</span><span class="p">,</span>  <span class="mf">0.55686274510</span><span class="p">)),</span>
        <span class="mi">9</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Savannas&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.70980392157</span><span class="p">,</span>  <span class="mf">0.78823529412</span><span class="p">,</span>  <span class="mf">0.55686274510</span><span class="p">)),</span>
        <span class="mi">10</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Grasslands&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.88627450980</span><span class="p">,</span>  <span class="mf">0.88627450980</span><span class="p">,</span>  <span class="mf">0.75686274510</span><span class="p">)),</span>
        <span class="mi">11</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Permanent Wetlands&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.43921568628</span><span class="p">,</span>  <span class="mf">0.63921568628</span><span class="p">,</span>  <span class="mf">0.72941176471</span><span class="p">)),</span>
        <span class="mi">12</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Croplands&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.66666666667</span><span class="p">,</span>  <span class="mf">0.43921568628</span><span class="p">,</span>  <span class="mf">0.15686274510</span><span class="p">)),</span>
        <span class="mi">13</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Urban and Built up lands&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.86666666667</span><span class="p">,</span>  <span class="mf">0.78823529412</span><span class="p">,</span>  <span class="mf">0.78823529412</span><span class="p">)),</span>
        <span class="mi">14</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Cropland Natural Vegetation Mosaics&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.66666666667</span><span class="p">,</span>  <span class="mf">0.43921568628</span><span class="p">,</span>  <span class="mf">0.15686274510</span><span class="p">)),</span>
        <span class="mi">15</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Permanent Snow and Ice&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.81960784314</span><span class="p">,</span>  <span class="mf">0.86666666667</span><span class="p">,</span>  <span class="mf">0.97647058824</span><span class="p">)),</span>
        <span class="mi">16</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Barren Land&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.69803921569</span><span class="p">,</span>  <span class="mf">0.67843137255</span><span class="p">,</span>  <span class="mf">0.63921568628</span><span class="p">)),</span>
        <span class="mi">17</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Water Bodies&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.27843137255</span><span class="p">,</span>  <span class="mf">0.41960784314</span><span class="p">,</span>  <span class="mf">0.62745098039</span><span class="p">)),</span>
    <span class="p">}</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lc_colors</span> <span class="o">=</span> <span class="n">lc_type1_colors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask_data</span> <span class="o">=</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mask_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">clipped_data</span> <span class="o">=</span> <span class="n">mask_data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">watershed_shape</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mapping</span><span class="p">),</span> <span class="n">watershed_shape</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">landcover_data</span> <span class="o">=</span> <span class="n">clipped_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clipped_data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">clipped_data</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ids</span><span class="p">,</span> <span class="n">counts</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ids</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="mi">11</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;grey&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">colors</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">labels</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labelsp1</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lc_colors</span><span class="p">]</span>

<span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">clipped_data</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">counts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;MODIS LULC&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of number of pixels per LULC types&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span><span class="n">labelsp1</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([&lt;matplotlib.axis.XTick at 0x1aa246970&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa246940&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa1cdf40&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa28b760&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa28bd60&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa29e4f0&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa29ec40&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2a33d0&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa29e430&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa246c40&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2a3bb0&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2aa340&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2aaa90&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2b0220&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2aadc0&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2a3c10&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2b04f0&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2b0e80&gt;,
  &lt;matplotlib.axis.XTick at 0x1aa2b9610&gt;],
 [Text(-1.0, 0, &#39;Unclassified&#39;),
  Text(0.0, 0, &#39;Open Water&#39;),
  Text(1.0, 0, &#39;Evergreen Needleleaf Forests&#39;),
  Text(2.0, 0, &#39;Evergreen Broadleaf Forests&#39;),
  Text(3.0, 0, &#39;Deciduous Needleleaf Forests&#39;),
  Text(4.0, 0, &#39;Deciduous Broadleaf Forests&#39;),
  Text(5.0, 0, &#39;Mixed Forests&#39;),
  Text(6.0, 0, &#39;Closed Shrublands&#39;),
  Text(7.0, 0, &#39;Open Shrublands&#39;),
  Text(8.0, 0, &#39;Woody Savannas&#39;),
  Text(9.0, 0, &#39;Savannas&#39;),
  Text(10.0, 0, &#39;Grasslands&#39;),
  Text(11.0, 0, &#39;Permanent Wetlands&#39;),
  Text(12.0, 0, &#39;Croplands&#39;),
  Text(13.0, 0, &#39;Urban and Built up lands&#39;),
  Text(14.0, 0, &#39;Cropland Natural Vegetation Mosaics&#39;),
  Text(15.0, 0, &#39;Permanent Snow and Ice&#39;),
  Text(16.0, 0, &#39;Barren Land&#39;),
  Text(17.0, 0, &#39;Water Bodies&#39;)])
</pre></div>
</div>
<img alt="../_images/MODIS_53_1.png" src="../_images/MODIS_53_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">clipped_data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">levels</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add_colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="c1"># cb.set_ticks(nlcd_ticks)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="n">watershed_shape</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;minx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;maxx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;miny&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="s1">&#39;maxy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(41.88587874311008, 42.035236269932035)
</pre></div>
</div>
<img alt="../_images/MODIS_54_1.png" src="../_images/MODIS_54_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ilandcover</span> <span class="o">=</span> <span class="n">landcover_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span> <span class="s2">&quot;2018-01-01&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:]</span>

<span class="c1"># ilandcover.shape</span>
<span class="n">lc_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">landcover_data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">landcover_data</span><span class="o">.</span><span class="n">values</span><span class="p">)])</span>
<span class="n">lc_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lc_ids</span><span class="p">]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">LAI_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LAI_lc</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">itime</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
<span class="c1">#     itime = times[0]</span>
    <span class="n">iCC_LAI</span> <span class="o">=</span> <span class="n">LAI_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span> <span class="n">itime</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

    <span class="n">iLAI_lc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ilabel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lc_ids</span><span class="p">,</span> <span class="n">lc_labels</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ilandcover</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="c1"># choose mean of the LAI for each landcover type</span>
        <span class="n">iLAI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">iCC_LAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]))</span>

        <span class="n">iLAI_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLAI</span><span class="p">)</span>
    
    <span class="n">LAI_lc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iLAI_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LAI_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">LAI_lc</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">lc_labels</span><span class="p">)</span>
<span class="n">LAI_df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_data</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_datetimeindex</span><span class="p">()</span>
<span class="n">LAI_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-36-afca7925ce50&gt;:2: RuntimeWarning: Converting a CFTimeIndex with dates from a non-standard calendar, &#39;julian&#39;, to a pandas.DatetimeIndex, which uses dates from the standard calendar.  This may lead to subtle errors in operations that depend on the length of time between dates.
  LAI_df[&#39;datetime&#39;] = LAI_data.indexes[&#39;time&#39;].to_datetimeindex()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LAI_df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;LAI [-]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s2">&quot;2016-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-01-01&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(16801.0, 17897.0)
</pre></div>
</div>
<img alt="../_images/MODIS_58_1.png" src="../_images/MODIS_58_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LAI_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">dest_dir</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_MODIS_LAI_df-raw.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="save-to-hdf5">
<h2>save to HDF5<a class="headerlink" href="#save-to-hdf5" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_LAI</span><span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">dest_dir</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_MODIS_LAI_072002_122020.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]:</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">nlcd_LAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="select-dominant-lulc-types-and-use-their-lai-values-for-ats-run">
<h1>Select dominant LULC types and use their LAI values for ATS run<a class="headerlink" href="#select-dominant-lulc-types-and-use-their-lai-values-for-ats-run" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">landcover_data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">landcover_data</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sum1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">sum1</span><span class="o">*</span><span class="mf">0.05</span> <span class="c1">#Separate LULC types with 5% of the pixel coverage cutoff</span>
<span class="n">cutoff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1026.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([20183,   304,    33])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">counts</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">cutoff</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ids1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors1</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids1</span><span class="p">]</span>
<span class="n">labels1</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_colors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Deciduous Broadleaf Forests&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids1</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ids1</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">countLULCclass</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
<span class="n">countLULCclass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ids</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">CC_landcover</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">CC_landcover</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">dom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="o">-</span><span class="n">counts</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">])</span>  <span class="c1"># prints the 5 most frequent LULC IDs</span>
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">dom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="o">-</span><span class="n">counts</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))[:</span><span class="mi">3</span><span class="p">]</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">])</span>  <span class="c1"># prints the 3 most frequent LULC IDs</span>
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">dom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="o">-</span><span class="n">counts</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">])</span>  <span class="c1"># prints the 2 most frequent LULC IDs</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">dom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="o">-</span><span class="n">counts</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">))[:</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">])</span>  <span class="c1"># prints the most frequent LULC ID</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">]</span>
    <span class="n">LULC1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC2</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">LULC3</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">LULC4</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">LULC5</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">LULC1label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC2label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC3label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC4label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC5label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">]</span>
    <span class="n">LULC1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC2</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">LULC3</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">LULC1label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC2label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC3label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">]</span>
    <span class="n">LULC1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC2</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">LULC1label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC2label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ids</span><span class="p">[</span><span class="n">dom</span><span class="p">]</span>
    <span class="n">LULC1</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">LULC1label</span> <span class="o">=</span> <span class="n">lc_colors</span><span class="p">[</span><span class="n">LULC1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modis-and-nlcd-crosswalk">
<h1>MODIS and NLCD crosswalk<a class="headerlink" href="#modis-and-nlcd-crosswalk" title="Permalink to this headline">#</a></h1>
<p><font color='green'> Users may change the crosswalk between MODIS and NLCD labels based on their study area characterisctics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Colors are based on NLCD LULC colors</span>
<span class="n">MODIS_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Unclassified&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Open Water&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Evergreen Needleleaf Forests&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Evergreen Broadleaf Forests&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Deciduous Needleleaf Forests&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Deciduous Broadleaf Forests&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Mixed Forests&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Closed Shrublands&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Open Shrublands&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Woody Savannas&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Savannas&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Grasslands&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Permanent Wetlands&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Croplands&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Urban and Built up lands&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Cropland Natural Vegetation Mosaics&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Permanent Snow and Ice&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Barren Land&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Water Bodies&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NLCD_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Open Water&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Evergreen Forest&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Evergreen Forest&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Mixed Forest&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Shrub/Scrub&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Shrub/Scrub&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Woody Wetlands&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Pasture/Hay&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Grassland/Herbaceous&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Emergent Herbaceous Wetlands&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Cultivated Crops&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Developed, Medium Intensity&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Cultivated Crops&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Perrenial Ice/Snow&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Barren Land&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Open Water&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">:</span> <span class="n">MODIS_labels</span><span class="p">,</span> <span class="s1">&#39;NLCD_labels&#39;</span><span class="p">:</span> <span class="n">NLCD_labels</span><span class="p">})</span>
<span class="n">compare_labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MODIS_labels</th>
      <th>NLCD_labels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Unclassified</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Open Water</td>
      <td>Open Water</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Evergreen Needleleaf Forests</td>
      <td>Evergreen Forest</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Evergreen Broadleaf Forests</td>
      <td>Evergreen Forest</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Deciduous Needleleaf Forests</td>
      <td>Deciduous Forest</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Deciduous Broadleaf Forests</td>
      <td>Deciduous Forest</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Mixed Forests</td>
      <td>Mixed Forest</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Closed Shrublands</td>
      <td>Shrub/Scrub</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Open Shrublands</td>
      <td>Shrub/Scrub</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Woody Savannas</td>
      <td>Woody Wetlands</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Savannas</td>
      <td>Pasture/Hay</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Grasslands</td>
      <td>Grassland/Herbaceous</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Permanent Wetlands</td>
      <td>Emergent Herbaceous Wetlands</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Croplands</td>
      <td>Cultivated Crops</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Urban and Built up lands</td>
      <td>Developed, Medium Intensity</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Cropland Natural Vegetation Mosaics</td>
      <td>Cultivated Crops</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Permanent Snow and Ice</td>
      <td>Perrenial Ice/Snow</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Barren Land</td>
      <td>Barren Land</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Water Bodies</td>
      <td>Open Water</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NLCDLULC1label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC1label</span><span class="p">]</span>
<span class="n">NLCDLULC1label1</span> <span class="o">=</span> <span class="n">NLCDLULC1label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">NLCDLULC1label1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Deciduous Forest&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_LAI</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">if</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">NLCDLULC1label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC1label</span><span class="p">]</span>
    <span class="n">NLCDLULC1label1</span> <span class="o">=</span> <span class="n">NLCDLULC1label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC2label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC2label</span><span class="p">]</span>
    <span class="n">NLCDLULC2label1</span> <span class="o">=</span> <span class="n">NLCDLULC2label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC3label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC2label</span><span class="p">]</span>
    <span class="n">NLCDLULC3label1</span> <span class="o">=</span> <span class="n">NLCDLULC3label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC4label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC3label</span><span class="p">]</span>
    <span class="n">NLCDLULC4label1</span> <span class="o">=</span> <span class="n">NLCDLULC4label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC5label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC4label</span><span class="p">]</span>
    <span class="n">NLCDLULC5label1</span> <span class="o">=</span> <span class="n">NLCDLULC5label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC1label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC2label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC3label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC4label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC4label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC5label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC5label</span><span class="p">}]</span>
    
    <span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC4label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC5label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LAI [-]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">NLCDLULC1label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC1label</span><span class="p">]</span>
    <span class="n">NLCDLULC1label1</span> <span class="o">=</span> <span class="n">NLCDLULC1label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC2label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC2label</span><span class="p">]</span>
    <span class="n">NLCDLULC2label1</span> <span class="o">=</span> <span class="n">NLCDLULC2label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC3label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC2label</span><span class="p">]</span>
    <span class="n">NLCDLULC3label1</span> <span class="o">=</span> <span class="n">NLCDLULC3label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC1label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC2label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC3label</span><span class="p">}]</span>
    
    <span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LAI [-]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">NLCDLULC1label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC1label</span><span class="p">]</span>
    <span class="n">NLCDLULC1label1</span> <span class="o">=</span> <span class="n">NLCDLULC1label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">NLCDLULC2label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC2label</span><span class="p">]</span>
    <span class="n">NLCDLULC2label1</span> <span class="o">=</span> <span class="n">NLCDLULC2label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC1label</span><span class="p">}]</span>
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC2label</span><span class="p">}]</span>
    
    <span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LAI [-]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    
<span class="k">else</span><span class="p">:</span>
    <span class="n">NLCDLULC1label</span><span class="o">=</span><span class="n">compare_labels</span><span class="p">[</span><span class="n">compare_labels</span><span class="p">[</span><span class="s1">&#39;MODIS_labels&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">LULC1label</span><span class="p">]</span>
    <span class="n">NLCDLULC1label1</span> <span class="o">=</span> <span class="n">NLCDLULC1label</span><span class="p">[</span><span class="s1">&#39;NLCD_labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">nlcd_LAI</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAI_df</span><span class="p">[{</span><span class="n">LULC1label</span><span class="p">}]</span>
    
    <span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LAI [-]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/MODIS_79_0.png" src="../_images/MODIS_79_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_LAI</span><span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">nlcd_LAI</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><font color='green'> If any of the NLCD LULC types (for cropland, evergreen, deciduous or shrub) present twice in the dominant MODIS LULC category, remove one of them before the h5 file generation, otherwise similar name conflict would be present.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../data-raw/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_MODIS_LAI_072002_122020.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
   
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC4label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC5label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]:</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">nlcd_LAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../data-raw/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_MODIS_LAI_072002_122020.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
   
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC3label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]:</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">nlcd_LAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">elif</span><span class="p">(</span><span class="n">countLULCclass</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">countLULCclass</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../data-raw/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_MODIS_LAI_072002_122020.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
   
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC2label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]:</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">nlcd_LAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">h5</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;../data-raw/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_MODIS_LAI_072002_122020.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
   
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;time [s]&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;NLCD </span><span class="si">{</span><span class="n">NLCDLULC1label1</span><span class="si">}</span><span class="s1"> LAI [-]&#39;</span><span class="p">]:</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">nlcd_LAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "geo"
        },
        kernelOptions: {
            kernelName: "geo",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'geo'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="daymet.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Download Daymet</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="write_ATS_input.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Write ATS input file</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Pin Shuai, Ethan Coon, and etc.<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>